webpackJsonp([2],{107:function(e,t,u){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=u(5),d=a(o),n=u(10),r=a(n),i=u(11),l=a(i),s=u(12),f=a(s),c=u(14),m=a(c),v=u(13),p=a(v),_=u(3),h=a(_),g=u(19),y=u(40),N=u(25),M=a(N),C=u(117),b=a(C),k=function(e){function t(){return(0,l["default"])(this,t),(0,m["default"])(this,(0,r["default"])(t).apply(this,arguments))}return(0,p["default"])(t,e),(0,f["default"])(t,[{key:"toggleReply",value:function(e){$("#"+e).toggle("normal")}},{key:"createComment",value:function(e){var t=this.props,u=t.type,a=t.refe,o=this,d=this.refs.replyContent.value,n={type:u,refe:a,content:d,reply:e};this.props.createComment(n,e).then(function(){o.cancelReply(e)})}},{key:"cancelReply",value:function(e){this.refs.replyContent.value="",$("#"+e).slideUp()}},{key:"deleteComment",value:function(e){this.props.deleteComment(e)}},{key:"render",value:function(){var e=this.props.comment;return(0,d["default"])("div",{className:"comment"},void 0,(0,d["default"])(g.Link,{className:"avatar",to:"/users/"+e.author._id},void 0,(0,d["default"])("img",{src:e.author.avatar})),(0,d["default"])("div",{className:"content"},void 0,(0,d["default"])(g.Link,{className:"author",to:"/users/"+e.author._id},void 0,e.author.name),(0,d["default"])("div",{className:"metadata"},void 0,(0,d["default"])("span",{className:"date"},void 0,(0,y.idToFromNow)(e._id))),(0,d["default"])("div",{className:"text"},void 0,e.content),e.reply?(0,d["default"])("div",{className:"text "+b["default"].replyContent},void 0,(0,d["default"])(g.Link,{to:"/users/"+e.reply.author._id},void 0,e.reply.author.name,": "),e.reply.content):null,(0,d["default"])("div",{className:"actions"},void 0,M["default"].uid()===(e.author&&e.author._id)?(0,d["default"])("a",{className:"reply",onClick:this.deleteComment.bind(this,e._id)},void 0,"删除"):null,(0,d["default"])("a",{className:"reply",onClick:this.toggleReply.bind(this,e._id)},void 0,"回复"))),(0,d["default"])("form",{className:"ui reply form",id:e._id,hidden:!0},void 0,(0,d["default"])("div",{className:"field"},void 0,h["default"].createElement("textarea",{ref:"replyContent"})),(0,d["default"])("div",{className:"ui submit icon button",onClick:this.createComment.bind(this,e._id)},void 0,"留言"),(0,d["default"])("div",{className:"ui submit icon button",onClick:this.cancelReply.bind(this,e._id)},void 0,"取消")))}}]),t}(_.Component);t["default"]=k},108:function(e,t,u){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=u(107),d=a(o);t["default"]=d["default"]},109:function(e,t,u){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=u(5),d=a(o),n=u(17),r=a(n),i=u(10),l=a(i),s=u(11),f=a(s),c=u(12),m=a(c),v=u(14),p=a(v),_=u(13),h=a(_),g=u(3),y=a(g),N=(u(19),u(118)),M=a(N),C=u(108),b=a(C),k=(0,d["default"])("div",{className:"four wide column"}),E=(0,d["default"])("h3",{className:"ui dividing header"},void 0,"留言"),G=function(e){function t(){return(0,f["default"])(this,t),(0,p["default"])(this,(0,l["default"])(t).apply(this,arguments))}return(0,h["default"])(t,e),(0,m["default"])(t,[{key:"createComment",value:function(){var e=this,t=this.refs.content.value,u=this.props,a=u.type,o=u.refe,d={type:a,content:t,refe:o,reply:""};this.props.createComment(d).then(function(){e.refs.content.value=""})}},{key:"renderComments",value:function(){var e=this,t=this.props.comments;return t.map(function(t,u){return y["default"].createElement(b["default"],(0,r["default"])({key:u,comment:t},e.props))})}},{key:"render",value:function(){return(0,d["default"])("div",{className:M["default"].cComment},void 0,(0,d["default"])("div",{className:"ui grid"},void 0,k,(0,d["default"])("div",{className:"eight wide column"},void 0,(0,d["default"])("div",{className:"ui segment"},void 0,(0,d["default"])("div",{className:"ui minimal comments"},void 0,E,this.renderComments(),(0,d["default"])("form",{className:"ui reply form"},void 0,(0,d["default"])("div",{className:"field"},void 0,y["default"].createElement("textarea",{ref:"content"})),(0,d["default"])("div",{className:"ui submit icon button",onClick:this.createComment.bind(this)},void 0,"留言")))))))}}]),t}(g.Component);t["default"]=G},110:function(e,t,u){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=u(109),d=a(o);t["default"]=d["default"]},117:function(e,t){e.exports={replyContent:"Comment__replyContent___c0c52"}},118:function(e,t){e.exports={cComment:"Comments__cComment___1fb6M",replyContent:"Comments__replyContent___3Deya"}},156:function(e,t,u){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=u(5),d=a(o),n=u(10),r=a(n),i=u(11),l=a(i),s=u(12),f=a(s),c=u(14),m=a(c),v=u(13),p=a(v),_=u(3),h=(a(_),u(19)),g=u(25),y=a(g),N=u(40),M=u(94),C=(a(M),u(200)),b=a(C),k=u(76),E=a(k),G=(0,d["default"])("div",{className:"text"}),O=(0,d["default"])("i",{className:"dropdown icon"}),R=(0,d["default"])("div",{className:"divider"}),P=function(e){function t(){return(0,l["default"])(this,t),(0,m["default"])(this,(0,r["default"])(t).apply(this,arguments))}return(0,p["default"])(t,e),(0,f["default"])(t,[{key:"componentDidMount",value:function(){$(".ui.dropdown").dropdown(),$(".ui.dropdown .item").removeClass("active")}},{key:"isMaster",value:function(){var e=this.props.group;return y["default"].uid()===(e.master&&e.master._id)}},{key:"render",value:function(){var e=this.props,t=e.group,u=e.recommend,a=e.report,o=e.joinGroup,n=e.leaveGroup;return(0,d["default"])("div",{className:b["default"].cGroup},void 0,(0,d["default"])("div",{className:"ui grid","v-show":"group.master"},void 0,(0,d["default"])(E["default"],{url:"/users/"+t.master._id,src:t.master.avatar}),(0,d["default"])("div",{className:"eight wide column"},void 0,(0,d["default"])("div",{className:"ui segment"},void 0,(0,d["default"])(h.Link,{to:"/groups/"+t._id},void 0,t.cover?(0,d["default"])("img",{className:b["default"].photo,src:t.cover}):null),(0,d["default"])("h3",{className:"title"},void 0,(0,d["default"])(h.Link,{to:"/groups/"+t._id},void 0,t.name)),(0,d["default"])("pre",{className:"content"},void 0,t.description),(0,d["default"])("div",{},void 0,(0,d["default"])("span",{className:b["default"].tag},void 0,(0,N.idToFromNow)(t._id)),(0,d["default"])("span",{className:"tag right "+b["default"].rightTag},void 0,(0,d["default"])(h.Link,{to:"/groups/"+t._id},void 0,"成员(",t.memberCount,") "),(0,d["default"])("div",{className:"ui inline dropdown"},void 0,G,O,this.isMaster()?(0,d["default"])("div",{className:"menu"},void 0,(0,d["default"])("div",{className:"item","data-text":"",onClick:function(){return u("group",t._id)}},void 0,"推荐置顶"),(0,d["default"])("div",{className:"item","data-text":"",onClick:function(){return a("group",t._id)}},void 0,"举报"),R,(0,d["default"])(h.Link,{className:"item "+b["default"].edit,"data-text":"",to:"/groups/"+t._id+"/edit"},void 0,"编辑")):(0,d["default"])("div",{className:"menu"},void 0,(0,d["default"])("div",{className:"item","data-text":"",onClick:function(){return u("group",t._id)}},void 0,"推荐置顶"),(0,d["default"])("div",{className:"item","data-text":"",onClick:function(){return a("group",t._id)}},void 0,"举报"),t.hasJoined?(0,d["default"])("div",{className:"item","data-text":"",onClick:function(){return n(t._id)}},void 0,"退出诗社"):(0,d["default"])("div",{className:"item","data-text":"",onClick:function(){return o(t._id)}},void 0,"申请加入")))))))))}}]),t}(_.Component);t["default"]=P},157:function(e,t,u){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=u(156),d=a(o);t["default"]=d["default"]},200:function(e,t){e.exports={tag:"Group__tag___2QmKz",cGroup:"Group__cGroup___3jrLe",photo:"Group__photo___19Ah9",rightTag:"Group__rightTag___bdnl1 Group__tag___2QmKz",edit:"Group__edit___1dbjK"}},230:function(e,t,u){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function o(e){return{type:h,data:e}}function d(e){return function(t){return(0,p["default"])("groups/"+e).then(function(u){u.ok&&t(o(u.data)),t(r(e)),t((0,_.getCommentsByGroupId)(e))})}}function n(e){return{type:g,data:e}}function r(e){var t=arguments.length<=1||void 0===arguments[1]?200:arguments[1],u=arguments.length<=2||void 0===arguments[2]?"":arguments[2];return function(a){return(0,p["default"])("groups/"+e+"/members?limit="+t+"&lastId="+u).then(function(e){e.ok&&a(n(e.data))})}}function i(){var e=arguments.length<=0||void 0===arguments[0]?N:arguments[0],t=arguments[1],u=y[t.type];return u?u(e,t):e}Object.defineProperty(t,"__esModule",{value:!0}),t.actions=t.RECEIVE_GROUP_MEMBERS=t.RECEIVE_GROUP=void 0;var l,s=u(58),f=a(s),c=u(17),m=a(c);t.getGroup=d,t.getGroupMembers=r,t["default"]=i;var v=u(49),p=a(v),_=u(95),h=t.RECEIVE_GROUP="RECEIVE_GROUP",g=t.RECEIVE_GROUP_MEMBERS="RECEIVE_GROUP_MEMBERS",y=(t.actions={getGroup:d,joinGroup:_.joinGroup,leaveGroup:_.leaveGroup,recommend:_.recommend,report:_.report,createComment:_.createComment,deleteComment:_.deleteComment},l={},(0,f["default"])(l,h,function(e,t){return(0,m["default"])({},e,{group:t.data})}),(0,f["default"])(l,g,function(e,t){return(0,m["default"])({},e,{groupMembers:t.data})}),(0,f["default"])(l,_.RECEIVE_COMMENTS,function(e,t){var u=t.data;return(0,m["default"])({},e,{comments:u})}),(0,f["default"])(l,_.DELETE_COMMENT_BY_ID,function(e,t){return(0,m["default"])({},e,{comments:e.comments.filter(function(e){return e._id!==t.commentId})})}),l),N={group:null,groupMembers:[],comments:[]}},442:function(e,t,u){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=u(5),d=a(o),n=u(10),r=a(n),i=u(11),l=a(i),s=u(12),f=a(s),c=u(14),m=a(c),v=u(13),p=a(v),_=u(3),h=(a(_),u(19)),g=u(40),y=u(25),N=a(y),M=u(733),C=(a(M),function(e){function t(){return(0,l["default"])(this,t),(0,m["default"])(this,(0,r["default"])(t).apply(this,arguments))}return(0,p["default"])(t,e),(0,f["default"])(t,[{key:"isMaster",value:function(){var e=this.props.group;return N["default"].uid()===(e&&e.master&&e.master._id)}},{key:"render",value:function(){var e=this.props,t=e.member;e.i;return(0,d["default"])("div",{className:"comment"},void 0,(0,d["default"])(h.Link,{className:"avatar",to:"/users/"+t.user._id},void 0,(0,d["default"])("img",{src:t.user.avatar})),(0,d["default"])("div",{className:"content"},void 0,(0,d["default"])(h.Link,{className:"author",to:"/users/"+t.user._id},void 0,t.user.name),(0,d["default"])("div",{className:"metadata"},void 0,(0,d["default"])("span",{className:"date"},void 0,(0,g.idToFromNow)(t._id),"加入")),(0,d["default"])("div",{className:"text"},void 0,t.user.bio||t.user.name),(0,d["default"])("div",{className:"actions"},void 0,this.isMaster()&&t.user._id!==group.master._id?(0,d["default"])("a",{className:"reply",onClick:function(){return removeUserFromGroup(t.user._id)}},void 0,"移出诗社"):null)))}}]),t}(_.Component));t["default"]=C},443:function(e,t,u){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=u(442),d=a(o);t["default"]=d["default"]},460:function(e,t,u){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=u(17),d=a(o),n=u(5),r=a(n),i=u(10),l=a(i),s=u(11),f=a(s),c=u(12),m=a(c),v=u(14),p=a(v),_=u(13),h=a(_),g=u(3),y=a(g),N=u(62),M=a(N),C=u(63),b=a(C),k=u(157),E=a(k),G=u(110),O=a(G),R=u(462),P=a(R),j=(0,r["default"])(M["default"],{}),w=(0,r["default"])(b["default"],{}),x=function(e){function t(){return(0,f["default"])(this,t),(0,p["default"])(this,(0,l["default"])(t).apply(this,arguments))}return(0,h["default"])(t,e),(0,m["default"])(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.getGroup,u=e.params.groupId;t(u)}},{key:"render",value:function(){var e=this.props,t=e.comments,u=e.groupMembers,a=e.group,o=e.params.groupId;return(0,r["default"])("div",{},void 0,j,w,a?y["default"].createElement(E["default"],(0,d["default"])({group:a},this.props)):null,(0,r["default"])(P["default"],{group:a,groupMembers:u}),y["default"].createElement(O["default"],(0,d["default"])({comments:t,type:"group",refe:o},this.props)))}}]),t}(g.Component);t["default"]=x},461:function(e,t,u){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=u(5),d=a(o),n=u(10),r=a(n),i=u(11),l=a(i),s=u(12),f=a(s),c=u(14),m=a(c),v=u(13),p=a(v),_=u(3),h=(a(_),u(443)),g=a(h),y=u(742),N=a(y),M=(0,d["default"])("div",{className:"four wide column"}),C=(0,d["default"])("h3",{className:"ui dividing header"},void 0,"诗社成员"),b=(0,d["default"])("i",{className:"angle down icon"}),k=function(e){function t(){return(0,l["default"])(this,t),(0,m["default"])(this,(0,r["default"])(t).apply(this,arguments))}return(0,p["default"])(t,e),(0,f["default"])(t,[{key:"renderGroupMembers",value:function(){var e=this.props,t=e.groupMembers,u=e.group;return t.map(function(e,t){return(0,d["default"])(g["default"],{member:e,group:u},t)})}},{key:"render",value:function(){return(0,d["default"])("div",{className:N["default"].cGroupMembers},void 0,(0,d["default"])("div",{className:"ui grid"},void 0,M,(0,d["default"])("div",{className:"eight wide column"},void 0,(0,d["default"])("div",{className:"ui segment"},void 0,(0,d["default"])("div",{className:"ui minimal comments"},void 0,C,this.renderGroupMembers(),(0,d["default"])("div",{className:N["default"].loadMore,onClick:function(){return loadMore},"v-show":"hasMore"},void 0,b))))))}}]),t}(_.Component);t["default"]=k},462:function(e,t,u){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=u(461),d=a(o);t["default"]=d["default"]},463:function(e,t,u){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=u(17),d=a(o),n=u(45),r=u(230),i=u(460),l=a(i),s=(0,d["default"])({},r.actions),f=function(e){var t=e.group,u=t.group,a=t.groupMembers,o=t.comments;return{group:u,groupMembers:a,comments:o}};t["default"]=(0,n.connect)(f,s)(l["default"])},733:741,742:function(e,t){e.exports={cGroupMembers:"GroupMembers__cGroupMembers___aBWLy",loadMore:"GroupMembers__loadMore___WdKs-"}}});