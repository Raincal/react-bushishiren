webpackJsonp([3],{107:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),a=o(i),u=n(9),r=o(u),l=n(10),d=o(l),s=n(11),f=o(s),c=n(13),p=o(c),m=n(12),v=o(m),h=n(3),y=o(h),_=n(19),C=n(43),E=n(25),b=o(E),g=n(117),P=o(g),M=function(e){function t(){return(0,d["default"])(this,t),(0,p["default"])(this,(0,r["default"])(t).apply(this,arguments))}return(0,v["default"])(t,e),(0,f["default"])(t,[{key:"toggleReply",value:function(e){$("#"+e).toggle("normal")}},{key:"createComment",value:function(e){var t=this.props,n=t.type,o=t.refe,i=this,a=this.refs.replyContent.value,u={type:n,refe:o,content:a,reply:e};this.props.createComment(u,e).then(function(){i.cancelReply(e)})}},{key:"cancelReply",value:function(e){this.refs.replyContent.value="",$("#"+e).slideUp()}},{key:"deleteComment",value:function(e){this.props.deleteComment(e)}},{key:"render",value:function(){var e=this.props.comment;return(0,a["default"])("div",{className:"comment"},void 0,(0,a["default"])(_.Link,{className:"avatar",to:"/users/"+e.author._id},void 0,(0,a["default"])("img",{src:e.author.avatar})),(0,a["default"])("div",{className:"content"},void 0,(0,a["default"])(_.Link,{className:"author",to:"/users/"+e.author._id},void 0,e.author.name),(0,a["default"])("div",{className:"metadata"},void 0,(0,a["default"])("span",{className:"date"},void 0,(0,C.idToFromNow)(e._id))),(0,a["default"])("div",{className:"text"},void 0,e.content),e.reply?(0,a["default"])("div",{className:"text "+P["default"].replyContent},void 0,(0,a["default"])(_.Link,{to:"/users/"+e.reply.author._id},void 0,e.reply.author.name,": "),e.reply.content):null,(0,a["default"])("div",{className:"actions"},void 0,b["default"].uid()===(e.author&&e.author._id)?(0,a["default"])("a",{className:"reply",onClick:this.deleteComment.bind(this,e._id)},void 0,"删除"):null,(0,a["default"])("a",{className:"reply",onClick:this.toggleReply.bind(this,e._id)},void 0,"回复"))),(0,a["default"])("form",{className:"ui reply form",id:e._id,hidden:!0},void 0,(0,a["default"])("div",{className:"field"},void 0,y["default"].createElement("textarea",{ref:"replyContent"})),(0,a["default"])("div",{className:"ui submit icon button",onClick:this.createComment.bind(this,e._id)},void 0,"留言"),(0,a["default"])("div",{className:"ui submit icon button",onClick:this.cancelReply.bind(this,e._id)},void 0,"取消")))}}]),t}(h.Component);t["default"]=M},108:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(107),a=o(i);t["default"]=a["default"]},109:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),a=o(i),u=n(15),r=o(u),l=n(9),d=o(l),s=n(10),f=o(s),c=n(11),p=o(c),m=n(13),v=o(m),h=n(12),y=o(h),_=n(3),C=o(_),E=(n(19),n(118)),b=o(E),g=n(108),P=o(g),M=(0,a["default"])("div",{className:"four wide column"}),O=(0,a["default"])("h3",{className:"ui dividing header"},void 0,"留言"),k=function(e){function t(){return(0,f["default"])(this,t),(0,v["default"])(this,(0,d["default"])(t).apply(this,arguments))}return(0,y["default"])(t,e),(0,p["default"])(t,[{key:"createComment",value:function(){var e=this,t=this.refs.content.value,n=this.props,o=n.type,i=n.refe,a={type:o,content:t,refe:i,reply:""};this.props.createComment(a).then(function(){e.refs.content.value=""})}},{key:"renderComments",value:function(){var e=this,t=this.props.comments;return t.map(function(t,n){return C["default"].createElement(P["default"],(0,r["default"])({key:n,comment:t},e.props))})}},{key:"render",value:function(){return(0,a["default"])("div",{className:b["default"].cComment},void 0,(0,a["default"])("div",{className:"ui grid"},void 0,M,(0,a["default"])("div",{className:"eight wide column"},void 0,(0,a["default"])("div",{className:"ui segment"},void 0,(0,a["default"])("div",{className:"ui minimal comments"},void 0,O,this.renderComments(),(0,a["default"])("form",{className:"ui reply form"},void 0,(0,a["default"])("div",{className:"field"},void 0,C["default"].createElement("textarea",{ref:"content"})),(0,a["default"])("div",{className:"ui submit icon button",onClick:this.createComment.bind(this)},void 0,"留言")))))))}}]),t}(_.Component);t["default"]=k},110:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(109),a=o(i);t["default"]=a["default"]},117:function(e,t){e.exports={replyContent:"Comment__replyContent___c0c52"}},118:function(e,t){e.exports={cComment:"Comments__cComment___1fb6M",replyContent:"Comments__replyContent___3Deya"}},161:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(){return{type:C,isFetching:!0}}function a(e){return{type:_,isFetching:!1,data:e}}function u(e){return function(t){return t(i()),(0,m["default"])("poems/"+e).then(function(n){n.ok&&(t(a(n.data)),h["default"].uid()&&t((0,y.getPoetries)(h["default"].uid()))),t((0,y.fetchCommentsByPoemId)(e))})}}function r(){var e=arguments.length<=0||void 0===arguments[0]?b:arguments[0],t=arguments[1],n=E[t.type];return n?n(e,t):e}Object.defineProperty(t,"__esModule",{value:!0}),t.actions=t.REQUEST_POEM=t.RECEIVE_POEM=void 0;var l,d=n(54),s=o(d),f=n(15),c=o(f);t.fetchPoem=u,t["default"]=r;var p=n(42),m=o(p),v=n(25),h=o(v),y=n(77),_=t.RECEIVE_POEM="RECEIVE_POEM",C=t.REQUEST_POEM="REQUEST_POEM",E=(t.actions={fetchPoem:u,deletePoem:y.deletePoem,recommend:y.recommend,report:y.report,addPoemToPoetry:y.addPoemToPoetry,createComment:y.createComment,deleteComment:y.deleteComment},l={},(0,s["default"])(l,C,function(e,t){return(0,c["default"])({},e,{isFetching:t.isFetching})}),(0,s["default"])(l,_,function(e,t){return(0,c["default"])({},e,{isFetching:t.isFetching,poem:t.data})}),(0,s["default"])(l,y.RECEIVE_POETRIES,function(e,t){return(0,c["default"])({},e,{poetries:t.data})}),(0,s["default"])(l,y.RECEIVE_COMMENTS,function(e,t){var n=t.data;return(0,c["default"])({},e,{comments:n})}),(0,s["default"])(l,y.DELETE_COMMENT_BY_ID,function(e,t){return(0,c["default"])({},e,{comments:e.comments.filter(function(e){return e._id!==t.commentId})})}),l),b={poem:null,isFetching:!1,poetries:[],comments:[]}},234:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(15),a=o(i),u=n(39),r=n(161),l=n(477),d=o(l),s=(0,a["default"])({},r.actions),f=function(e){return{isFetching:e.poem.isFetching,poem:e.poem.poem,poetries:e.poem.poetries,comments:e.poem.comments}};t["default"]=(0,u.connect)(f,s)(d["default"])},477:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(15),a=o(i),u=n(4),r=o(u),l=n(9),d=o(l),s=n(10),f=o(s),c=n(11),p=o(c),m=n(13),v=o(m),h=n(12),y=o(h),_=n(3),C=o(_),E=n(56),b=o(E),g=n(57),P=o(g),M=n(158),O=o(M),k=n(110),N=o(k),x=n(764),T=o(x),w=(0,r["default"])(b["default"],{}),j=(0,r["default"])(P["default"],{}),R=(0,r["default"])(T["default"],{active:!0}),F=function(e){function t(){return(0,f["default"])(this,t),(0,v["default"])(this,(0,d["default"])(t).apply(this,arguments))}return(0,y["default"])(t,e),(0,p["default"])(t,[{key:"componentDidMount",value:function(){var e=this.props.params.poemid;this.props.fetchPoem(e)}},{key:"render",value:function(){var e=this.props,t=e.isFetching,n=e.poem,o=e.comments,i=e.params.poemid;return(0,r["default"])("div",{},void 0,w,j,!t&&n?C["default"].createElement(O["default"],(0,a["default"])({poem:n},this.props)):R,C["default"].createElement(N["default"],(0,a["default"])({comments:o,type:"poem",refe:i},this.props)))}}]),t}(_.Component);t["default"]=F},764:function(e,t,n){!function(t,o){e.exports=o(n(3))}(this,function(e){return function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(e,t,n){for(var o=!0;o;){var i=e,a=t,u=n;r=d=l=void 0,o=!1,null===i&&(i=Function.prototype);var r=Object.getOwnPropertyDescriptor(i,a);if(void 0!==r){if("value"in r)return r.value;var l=r.get;if(void 0===l)return;return l.call(u)}var d=Object.getPrototypeOf(i);if(null===d)return;e=d,t=a,n=u,o=!0}},l=n(1),d=o(l),s=function(e){function t(e){i(this,t),r(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={width:0,left:0}}return a(t,e),u(t,[{key:"componentDidMount",value:function(){this.interval=setInterval(this.animate.bind(this),this.props.speed)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"animate",value:function(){if(this.props.active!==!0)return!1;var e=this.state,t=e.left,n=e.width;0===t&&100>n?n+=4:100>=n&&100>t?(t+=4,n-=4):100===t&&0===n&&(t=0),this.setState({left:t,width:n})}},{key:"render",value:function(){var e={display:this.props.active?"block":"none",position:"fixed",top:"0px",left:this.state.left+"%",right:"0px",width:this.state.width+"%",height:this.props.height,backgroundColor:this.props.color,zIndex:800};return d["default"].createElement("div",{style:e})}}]),t}(d["default"].Component);t["default"]=s,s.defaultProps={active:!1,speed:20,color:"#60d778",height:"2px"},s.propTypes={active:d["default"].PropTypes.bool,speed:d["default"].PropTypes.number,color:d["default"].PropTypes.string,height:d["default"].PropTypes.string},e.exports=t["default"]},function(t,n){t.exports=e}])})}});