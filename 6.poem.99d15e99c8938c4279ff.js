webpackJsonp([6],{107:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=o(i),a=n(5),u=o(a),l=n(6),d=o(l),s=n(7),f=o(s),c=n(9),p=o(c),m=n(8),v=o(m),h=n(3),_=o(h),y=n(16),C=n(36),E=n(19),b=o(E),g=n(128),P=o(g),M=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,u.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,f.default)(t,[{key:"toggleReply",value:function(e){$("#"+e).toggle("normal")}},{key:"createComment",value:function(e){var t=this.props,n=t.type,o=t.refe,i=this,r=this.refs.replyContent.value,a={type:n,refe:o,content:r,reply:e};this.props.createComment(a,e).then(function(){i.cancelReply(e)})}},{key:"cancelReply",value:function(e){this.refs.replyContent.value="",$("#"+e).slideUp()}},{key:"deleteComment",value:function(e){this.props.deleteComment(e)}},{key:"render",value:function(){var e=this.props.comment;return(0,r.default)("div",{className:"comment"},void 0,(0,r.default)(y.Link,{className:"avatar",to:"/users/"+e.author._id},void 0,(0,r.default)("img",{src:e.author.avatar})),(0,r.default)("div",{className:"content"},void 0,(0,r.default)(y.Link,{className:"author",to:"/users/"+e.author._id},void 0,e.author.name),(0,r.default)("div",{className:"metadata"},void 0,(0,r.default)("span",{className:"date"},void 0,(0,C.idToFromNow)(e._id))),(0,r.default)("div",{className:"text"},void 0,e.content),e.reply?(0,r.default)("div",{className:"text "+P.default.replyContent},void 0,(0,r.default)(y.Link,{to:"/users/"+e.reply.author._id},void 0,e.reply.author.name,": "),e.reply.content):null,(0,r.default)("div",{className:"actions"},void 0,b.default.uid()===(e.author&&e.author._id)?(0,r.default)("a",{className:"reply",onClick:this.deleteComment.bind(this,e._id)},void 0,"删除"):null,(0,r.default)("a",{className:"reply",onClick:this.toggleReply.bind(this,e._id)},void 0,"回复"))),(0,r.default)("form",{className:"ui reply form",id:e._id,hidden:!0},void 0,(0,r.default)("div",{className:"field"},void 0,_.default.createElement("textarea",{ref:"replyContent"})),(0,r.default)("div",{className:"ui submit icon button",onClick:this.createComment.bind(this,e._id)},void 0,"留言"),(0,r.default)("div",{className:"ui submit icon button",onClick:this.cancelReply.bind(this,e._id)},void 0,"取消")))}}]),t}(h.Component);t.default=M},108:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(107),r=o(i);t.default=r.default},109:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=o(i),a=n(11),u=o(a),l=n(5),d=o(l),s=n(6),f=o(s),c=n(7),p=o(c),m=n(9),v=o(m),h=n(8),_=o(h),y=n(3),C=o(y),E=(n(16),n(129)),b=o(E),g=n(108),P=o(g),M=(0,r.default)("div",{className:"four wide column"}),O=(0,r.default)("h3",{className:"ui dividing header"},void 0,"留言"),k=function(e){function t(){return(0,f.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,_.default)(t,e),(0,p.default)(t,[{key:"createComment",value:function(){var e=this,t=this.refs.content.value,n=this.props,o=n.type,i=n.refe,r={type:o,content:t,refe:i,reply:""};this.props.createComment(r).then(function(){e.refs.content.value=""})}},{key:"renderComments",value:function(){var e=this,t=this.props.comments;return t.map(function(t,n){return C.default.createElement(P.default,(0,u.default)({key:n,comment:t},e.props))})}},{key:"render",value:function(){return(0,r.default)("div",{className:b.default.cComment},void 0,(0,r.default)("div",{className:"ui grid"},void 0,M,(0,r.default)("div",{className:"eight wide column"},void 0,(0,r.default)("div",{className:"ui segment"},void 0,(0,r.default)("div",{className:"ui minimal comments"},void 0,O,this.renderComments(),(0,r.default)("form",{className:"ui reply form"},void 0,(0,r.default)("div",{className:"field"},void 0,C.default.createElement("textarea",{ref:"content"})),(0,r.default)("div",{className:"ui submit icon button",onClick:this.createComment.bind(this)},void 0,"留言")))))))}}]),t}(y.Component);t.default=k},110:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(109),r=o(i);t.default=r.default},128:function(e,t){e.exports={replyContent:"Comment__replyContent___c0c52"}},129:function(e,t){e.exports={cComment:"Comments__cComment___1fb6M",replyContent:"Comments__replyContent___3Deya"}},137:function(e,t,n){!function(t,o){e.exports=o(n(3))}(this,function(e){return function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=function(e,t,n){for(var o=!0;o;){var i=e,r=t,a=n;u=d=l=void 0,o=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,r);if(void 0!==u){if("value"in u)return u.value;var l=u.get;if(void 0===l)return;return l.call(a)}var d=Object.getPrototypeOf(i);if(null===d)return;e=d,t=r,n=a,o=!0}},l=n(1),d=o(l),s=function(e){function t(e){i(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={width:0,left:0}}return r(t,e),a(t,[{key:"componentDidMount",value:function(){this.interval=setInterval(this.animate.bind(this),this.props.speed)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"animate",value:function(){if(this.props.active!==!0)return!1;var e=this.state,t=e.left,n=e.width;0===t&&n<100?n+=4:n<=100&&t<100?(t+=4,n-=4):100===t&&0===n&&(t=0),this.setState({left:t,width:n})}},{key:"render",value:function(){var e={display:this.props.active?"block":"none",position:"fixed",top:"0px",left:this.state.left+"%",right:"0px",width:this.state.width+"%",height:this.props.height,backgroundColor:this.props.color,zIndex:800};return d.default.createElement("div",{style:e})}}]),t}(d.default.Component);t.default=s,s.defaultProps={active:!1,speed:20,color:"#60d778",height:"2px"},s.propTypes={active:d.default.PropTypes.bool,speed:d.default.PropTypes.number,color:d.default.PropTypes.string,height:d.default.PropTypes.string},e.exports=t.default},function(t,n){t.exports=e}])})},173:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(){return{type:C,isFetching:!0}}function r(e){return{type:y,isFetching:!1,data:e}}function a(e){return function(t){return t(i()),(0,m.default)("poems/"+e).then(function(n){n.ok&&(t(r(n.data)),h.default.uid()&&t((0,_.getPoetries)(h.default.uid()))),t((0,_.fetchCommentsByPoemId)(e))})}}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments[1],n=E[t.type];return n?n(e,t):e}Object.defineProperty(t,"__esModule",{value:!0}),t.actions=t.REQUEST_POEM=t.RECEIVE_POEM=void 0;var l,d=n(33),s=o(d),f=n(11),c=o(f);t.fetchPoem=a,t.default=u;var p=n(30),m=o(p),v=n(19),h=o(v),_=n(60),y=t.RECEIVE_POEM="RECEIVE_POEM",C=t.REQUEST_POEM="REQUEST_POEM",E=(t.actions={fetchPoem:a,deletePoem:_.deletePoem,recommend:_.recommend,report:_.report,addPoemToPoetry:_.addPoemToPoetry,createComment:_.createComment,deleteComment:_.deleteComment},l={},(0,s.default)(l,C,function(e,t){return(0,c.default)({},e,{isFetching:t.isFetching})}),(0,s.default)(l,y,function(e,t){return(0,c.default)({},e,{isFetching:t.isFetching,poem:t.data})}),(0,s.default)(l,_.RECEIVE_POETRIES,function(e,t){return(0,c.default)({},e,{poetries:t.data})}),(0,s.default)(l,_.RECEIVE_COMMENTS,function(e,t){var n=t.data;return(0,c.default)({},e,{comments:n})}),(0,s.default)(l,_.DELETE_COMMENT_BY_ID,function(e,t){return(0,c.default)({},e,{comments:e.comments.filter(function(e){return e._id!==t.commentId})})}),l),b={poem:null,isFetching:!1,poetries:[],comments:[]}},249:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(11),r=o(i),a=n(32),u=n(173),l=n(504),d=o(l),s=(0,r.default)({},u.actions),f=function(e){return{isFetching:e.poem.isFetching,poem:e.poem.poem,poetries:e.poem.poetries,comments:e.poem.comments}};t.default=(0,a.connect)(f,s)(d.default)},504:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(11),r=o(i),a=n(4),u=o(a),l=n(5),d=o(l),s=n(6),f=o(s),c=n(7),p=o(c),m=n(9),v=o(m),h=n(8),_=o(h),y=n(3),C=o(y),E=n(43),b=o(E),g=n(44),P=o(g),M=n(172),O=o(M),k=n(110),N=o(k),x=n(137),T=o(x),w=(0,u.default)(b.default,{}),j=(0,u.default)(P.default,{}),R=(0,u.default)(T.default,{active:!0}),F=function(e){function t(){return(0,f.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,_.default)(t,e),(0,p.default)(t,[{key:"componentWillMount",value:function(){var e=this.props.params.poemid;this.props.fetchPoem(e)}},{key:"render",value:function(){var e=this.props,t=e.isFetching,n=e.poem,o=e.comments,i=e.params.poemid;return(0,u.default)("div",{},void 0,w,j,!t&&n?C.default.createElement(O.default,(0,r.default)({poem:n},this.props)):R,C.default.createElement(N.default,(0,r.default)({comments:o,type:"poem",refe:i},this.props)))}}]),t}(y.Component);t.default=F}});